{"version":3,"file":"DropdownList.js","sourceRoot":"","sources":["../src/DropdownList.ts"],"names":[],"mappings":"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","sourcesContent":["import UI5Element from \"@ui5/webcomponents-base/dist/UI5Element.js\";\nimport customElement from \"@ui5/webcomponents-base/dist/decorators/customElement.js\";\nimport property from \"@ui5/webcomponents-base/dist/decorators/property.js\";\nimport slot from \"@ui5/webcomponents-base/dist/decorators/slot.js\";\nimport event from \"@ui5/webcomponents-base/dist/decorators/event.js\";\nimport litRender from \"@ui5/webcomponents-base/dist/renderer/LitRenderer.js\";\nimport {\n  isUp,\n  isDown,\n  isHome,\n  isEnd,\n} from \"@ui5/webcomponents-base/dist/Keys.js\";\nimport { getI18nBundle } from \"@ui5/webcomponents-base/dist/i18nBundle.js\";\nimport type I18nBundle from \"@ui5/webcomponents-base/dist/i18nBundle.js\";\nimport browserScrollbarCSS from \"@ui5/webcomponents/dist/generated/themes/BrowserScrollbar.css.js\";\nimport DropdownListItem from \"./DropdownListItem.js\";\nimport DropdownListTemplate from \"./generated/templates/DropdownListTemplate.lit.js\";\nimport { ARIA_LABEL_DROPDOWN_LIST_MULTISELECTABLE, ARIA_LABEL_DROPDOWN_LIST_SELECTABLE } from \"./generated/i18n/i18n-defaults.js\";\n\n// Styles\nimport DropdownListCss from \"./generated/themes/DropdownList.css.js\";\n\nexport enum DropdownListMode {\n  SingleSelect = \"SingleSelect\",\n  MultiSelect = \"MultiSelect\",\n}\n\n/**\n * @class\n *\n * <h3 class=\"comment-api-title\">Overview</h3>\n *\n *\n * <h3>Usage</h3>\n *\n * For the <code>udex-dropdown-list</code>\n * <h3>ES6 Module Import</h3>\n *\n * <code>import @udex/web-components/dist/DropdownList.js\";</code>\n *\n * @constructor\n * @author SAP SE\n * @alias sap.ui.webc.web-components.DropdownList\n * @extends sap.ui.webc.base.UI5Element\n * @tagname udex-dropdown-list\n * @public\n */\n@customElement({\n  tag: \"udex-dropdown-list\",\n  renderer: litRender,\n  styles: [DropdownListCss, browserScrollbarCSS],\n  template: DropdownListTemplate,\n  dependencies: [],\n})\n\n@event(\"selection-change\", {\n  detail: {\n    selectedItems: { type: Array },\n    item: { type: HTMLElement },\n  },\n})\n\nclass DropdownList extends UI5Element {\n  /**\n   * Defines the accessible role of the component.\n   *\n   * @type {string}\n   * @name sap.ui.webc.web-components.DropdownList.prototype.accessibleRole\n   * @defaultvalue \"list\"\n   * @public\n   */\n  @property({ defaultValue: \"list\" })\n  accessibleRole!: string;\n\n  /**\n   * Defines the accessible name of the component.\n   *\n   * @type {string}\n   * @name sap.ui.webc.web-components.DropdownList..prototype.accessibleName\n   * @defaultvalue \"\"\n   * @public\n   */\n  @property()\n  accessibleName!: string;\n\n  /**\n   * Defines the mode of the component.\n   *\n   * @type {string}\n   * @name sap.ui.webc.web-components.DropdownList.prototype.mode\n   * @defaultvalue \"SingleSelect\"\n   * @public\n   */\n  @property({ type: DropdownListMode, defaultValue: DropdownListMode.SingleSelect })\n  mode!: `${DropdownListMode}`;\n\n  /**\n   * Allows control over the height.\n   * @type {string}\n   * @name sap.ui.webc.web-components.DropdownList.prototype.height\n   * @public\n   */\n  @property({ type: String })\n  height?: string;\n\n  /**\n   * Slot for dropdown list items.\n   *\n   * @type @type {HTMLElement[]}\n   * @name sap.ui.webc.web-components.DropdownList.prototype.default\n   * @slot items\n   * @public\n   */\n  @slot({ type: HTMLElement, \"default\": true })\n  items!: Array<HTMLElement>;\n\n  static i18nBundle: I18nBundle;\n\n  static async onDefine(): Promise<void> {\n    DropdownList.i18nBundle = await getI18nBundle(\"sap-ui-webcomponents-bundle\");\n  }\n\n  onBeforeRendering() {\n    this.prepareListItemsMode();\n  }\n\n  handleItemPress(e: CustomEvent) {\n    e.stopPropagation();\n    const clickedItem = e.target as DropdownListItem;\n\n    if (this.mode === DropdownListMode.SingleSelect) {\n      this.revertSelectedItems();\n      clickedItem.selected = true;\n    }\n\n    this.fireEvent(\"selection-change\", {\n      selectedItems: this.getSelectedItems(),\n      item: clickedItem,\n    });\n  }\n\n  handleKeyDown(e: KeyboardEvent) {\n    this.handleUpArrow(e);\n    this.handleDownArrow(e);\n    this.handleHomeKey(e);\n    this.handleEndKey(e);\n  }\n\n  handleUpArrow(e: KeyboardEvent) {\n    if (isUp(e)) {\n      e.preventDefault();\n      const items = this.getKeyboardNavigationItems();\n      const currentSelectedIndex = this.getCurrentIndex(items, e.target as DropdownListItem);\n      const previousSelectIndex = currentSelectedIndex - 1 < 0 ? items.length - 1 : currentSelectedIndex - 1;\n      const isHeaderItem = this.isHeader(items[previousSelectIndex]);\n\n      if (isHeaderItem) {\n        this.focusHeader(items[previousSelectIndex]);\n        return;\n      }\n\n      items[previousSelectIndex].focus();\n    }\n  }\n\n  handleDownArrow(e: KeyboardEvent) {\n    if (isDown(e)) {\n      e.preventDefault();\n      const items = this.getKeyboardNavigationItems();\n      const currentSelectedIndex = this.getCurrentIndex(items, e.target as DropdownListItem);\n      const nextSelectIndex = currentSelectedIndex + 1 > items.length - 1 ? 0 : currentSelectedIndex + 1;\n      const isHeaderItem = this.isHeader(items[nextSelectIndex]);\n\n      if (isHeaderItem) {\n        this.focusHeader(items[nextSelectIndex]);\n        return;\n      }\n\n      items[nextSelectIndex].focus();\n    }\n  }\n\n  handleHomeKey(e: KeyboardEvent) {\n    if (isHome(e)) {\n      const items = this.getKeyboardNavigationItems();\n      const isHeaderItem = this.isHeader(items[0]);\n\n      if (isHeaderItem) {\n        this.focusHeader(items[0]);\n        return;\n      }\n\n      items[0].focus();\n    }\n  }\n\n  handleEndKey(e: KeyboardEvent) {\n    if (isEnd(e)) {\n      e.preventDefault();\n      const items = this.getKeyboardNavigationItems();\n      items[items.length - 1].focus();\n    }\n  }\n\n  revertSelectedItems() {\n    const previouslySelectedItems = this.getSelectedItems();\n    previouslySelectedItems.forEach((item: DropdownListItem) => {\n      item.selected = false;\n    });\n  }\n\n  focusHeader(item: DropdownListItem) {\n    const header = item.shadowRoot?.querySelector(\".udex-dropdown-list__group-header\") as HTMLElement;\n    header.focus();\n  }\n\n  getItems(): Array<DropdownListItem> {\n    return this.getSlottedNodes<DropdownListItem>(\"items\");\n  }\n\n  getSelectedItems(): Array<DropdownListItem> {\n    return this.getItemsFromList().filter(item => item.selected);\n  }\n\n  getCurrentIndex(items: Array<DropdownListItem>, item: DropdownListItem): number {\n    return items.indexOf(item);\n  }\n\n  getItemsWithoutHeader(): Array<DropdownListItem> {\n    return this.getItemsFromList().filter(item => !this.isHeader(item));\n  }\n\n  getKeyboardNavigationItems(): Array<DropdownListItem> {\n    const items = this.modeMultiSelect ? this.getItemsFromList() : this.getItemsWithoutHeader();\n    return items.filter(item => !item.disabled);\n  }\n\n  getItemsFromList(): Array<DropdownListItem> {\n    const items: DropdownListItem[] = [];\n    const slottedItems = this.getItems();\n\n    slottedItems.forEach(item => {\n      const childItems = item.children.length > 0 ? item.getItems() : [];\n      items.push(item, ...childItems);\n    });\n\n    return items;\n  }\n\n  prepareListItemsMode() {\n    const slottedItems = this.getItemsFromList();\n    slottedItems.forEach(item => {\n      item.mode = this.mode;\n    });\n  }\n\n  isHeader(item: DropdownListItem): boolean {\n    return item.tagName === \"UDEX-DROPDOWN-LIST-GROUP-HEADER\";\n  }\n\n  get ariaLabelModeText(): string {\n    if (this.modeMultiSelect) {\n      return DropdownList.i18nBundle.getText(ARIA_LABEL_DROPDOWN_LIST_MULTISELECTABLE);\n    }\n    return DropdownList.i18nBundle.getText(ARIA_LABEL_DROPDOWN_LIST_SELECTABLE);\n  }\n\n  get ariaLabelledBy() {\n    return `${this._id}-modeLabel`;\n  }\n\n  get modeMultiSelect() {\n    return this.mode === DropdownListMode.MultiSelect;\n  }\n\n  get holderHeight() {\n    return this.height ? this.height : \"auto\";\n  }\n}\n\nDropdownList.define();\n\nexport default DropdownList;\n"]}