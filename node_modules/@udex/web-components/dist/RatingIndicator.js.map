{"version":3,"file":"RatingIndicator.js","sourceRoot":"","sources":["../src/RatingIndicator.ts"],"names":[],"mappings":"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","sourcesContent":["import customElement from \"@ui5/webcomponents-base/dist/decorators/customElement.js\";\nimport event from \"@ui5/webcomponents-base/dist/decorators/event.js\";\nimport property from \"@ui5/webcomponents-base/dist/decorators/property.js\";\n\nimport UI5Element from \"@ui5/webcomponents-base/dist/UI5Element.js\";\nimport litRender from \"@ui5/webcomponents-base/dist/renderer/LitRenderer.js\";\nimport {\n  isDown,\n  isUp,\n  isLeft,\n  isRight,\n  isSpace,\n  isEnter,\n  isHome,\n  isEnd,\n} from \"@ui5/webcomponents-base/dist/Keys.js\";\nimport { getEffectiveAriaLabelText } from \"@ui5/webcomponents-base/dist/util/AriaLabelHelper.js\";\nimport { getI18nBundle } from \"@ui5/webcomponents-base/dist/i18nBundle.js\";\nimport type I18nBundle from \"@ui5/webcomponents-base/dist/i18nBundle.js\";\nimport Integer from \"@ui5/webcomponents-base/dist/types/Integer.js\";\nimport Float from \"@ui5/webcomponents-base/dist/types/Float.js\";\nimport Icon from \"@ui5/webcomponents/dist/Icon.js\";\nimport {\n  RATING_INDICATOR_TEXT,\n  RATING_INDICATOR_TOOLTIP_TEXT,\n  RATING_INDICATOR_ARIA_DESCRIPTION,\n} from \"./generated/i18n/i18n-defaults.js\";\nimport RatingIndicatorTemplate from \"./generated/templates/RatingIndicatorTemplate.lit.js\";\nimport \"@ui5/webcomponents-icons/dist/favorite.js\";\nimport \"@ui5/webcomponents-icons/dist/unfavorite.js\";\n\n// Styles\nimport RatingIndicatorCss from \"./generated/themes/RatingIndicator.css.js\";\n\ntype Star = {\n  selected: boolean,\n  index: number,\n  halfStar: boolean\n}\n\nenum DisplayType {\n  Desktop = \"Desktop\",\n  Mobile = \"Mobile\"\n}\n\n/**\n * @class\n *\n * ### Overview\n *\n * ### ES6 Module Import\n *\n * `import \"@ui5/webcomponents/dist/RatingIndicator.js\";`\n * @constructor\n * @extends UI5Element\n * @public\n */\n\n@customElement({\n  tag: \"udex-rating-indicator\",\n  renderer: litRender,\n  styles: RatingIndicatorCss,\n  template: RatingIndicatorTemplate,\n  dependencies: [Icon],\n})\n/**\n * The event is fired when the value changes.\n * @public\n */\n@event(\"change\")\nclass RatingIndicator extends UI5Element {\n  /**\n   * The indicated value of the rating.\n   *\n   * **Note:** If you set a number which is not round, it would be shown as follows:\n   *\n   * - 1.0 - 1.2 -> 1\n   * - 1.3 - 1.7 -> 1.5\n   * - 1.8 - 1.9 -> 2\n   * @default 0\n   * @public\n   */\n  @property({ validator: Float, defaultValue: 0 })\n    value!: number;\n\n  /**\n   * The number of displayed rating symbols.\n   * @default 5\n   * @public\n   */\n  @property({ validator: Integer, defaultValue: 5 })\n    max!: number;\n\n  /**\n   * Defines whether the component is disabled.\n   *\n   * **Note:** A disabled component is completely noninteractive.\n   * @default false\n   * @public\n   */\n  @property({ type: Boolean })\n    disabled!: boolean;\n\n  /**\n   * Defines whether the component is read-only.\n   *\n   * **Note:** A read-only component is not editable,\n   * but still provides visual feedback upon user interaction.\n   * @default false\n   * @public\n   */\n  @property({ type: Boolean })\n    readonly!: boolean;\n\n  /**\n   * Defines the accessible ARIA name of the component.\n   * @default \"\"\n   * @public\n   */\n  @property()\n    accessibleName!: string;\n\n  /**\n   * Receives id(or many ids) of the elements that label the component.\n   * @default \"\"\n   * @public\n   */\n  @property({ defaultValue: \"\" })\n    accessibleNameRef!: string;\n\n  /**\n  * Defines whether the component is required.\n  * @default false\n  * @public\n  */\n  @property({ type: Boolean })\n    required!: boolean;\n\n  /**\n   * Defines the tooltip of the component.\n   * @default \"\"\n   * @public\n   */\n  @property()\n    tooltip!: string;\n\n  /**\n   * Defines the display type of the component.\n   *\n   * @default DisplayType.Desktop\n   * @public\n   */\n  @property({ defaultValue: DisplayType.Desktop })\n    display!: DisplayType;\n\n  /**\n    * The number of total votes.\n    *\n    * @public\n    */\n  @property()\n    totalCount!: number;\n\n  /**\n   * @private\n   */\n  @property({ type: Object, multiple: true })\n    _stars!: Array<Star>;\n\n  /**\n   * @private\n   */\n  @property({ type: Boolean })\n    _focused!: boolean;\n\n  _liveValue?: number;\n\n  static i18nBundle: I18nBundle;\n\n  static async onDefine() {\n    RatingIndicator.i18nBundle = await getI18nBundle(\"@ui5/webcomponents\");\n  }\n\n  constructor() {\n    super();\n  }\n\n  onBeforeRendering() {\n    this.calcState();\n  }\n\n  calcState() {\n    this._stars = [];\n\n    for (let i = 1; i < this.max + 1; i++) {\n      const remainder = Math.round((this.value - Math.floor(this.value)) * 10);\n      let halfStar = false,\n        tempValue = this.value;\n\n      if (Math.floor(this.value) + 1 === i && remainder > 2 && remainder < 8) {\n        halfStar = true;\n      } else if (remainder <= 2) {\n        tempValue = Math.floor(this.value);\n      } else if (remainder >= 8) {\n        tempValue = Math.ceil(this.value);\n      }\n\n      this._stars.push({\n        selected: i <= tempValue,\n        index: i,\n        halfStar,\n      });\n    }\n  }\n\n  _onclick(e: MouseEvent) {\n    const target = e.target as UI5Element;\n\n    if (!(target instanceof HTMLElement) || this.disabled || this.readonly) {\n      return;\n    }\n\n    const targetValue = target.getAttribute(\"data-ui5-value\");\n\n    if (targetValue !== null) {\n      this.value = parseInt(targetValue);\n\n      if (this.value === 1 && this._liveValue === 1) {\n        this.value = 0;\n      }\n\n      if (this._liveValue !== this.value) {\n        this.fireEvent(\"change\");\n        this._liveValue = this.value;\n      }\n    }\n  }\n\n  _onkeydown(e: KeyboardEvent) {\n    if (this.disabled || this.readonly) {\n      return;\n    }\n\n    const isDecrease = isDown(e) || isLeft(e);\n    const isIncrease = isRight(e) || isUp(e);\n    const isIncreaseWithReset = isSpace(e) || isEnter(e);\n    const isMin = isHome(e);\n    const isMax = isEnd(e);\n    const isNumber = (e.keyCode >= 48 && e.keyCode <= 57) || (e.keyCode >= 96 && e.keyCode <= 105);\n\n    if (isDecrease || isIncrease || isIncreaseWithReset || isMin || isMax || isNumber) {\n      e.preventDefault();\n\n      if (isDecrease && this.value > 0) {\n        this.value = Math.round(this.value - 1);\n      } else if (isIncrease && this.value < this.max) {\n        this.value = Math.round(this.value + 1);\n      } else if (isIncreaseWithReset) {\n        const proposedValue = Math.round(this.value + 1);\n        this.value = proposedValue > this.max ? 0 : proposedValue;\n      } else if (isMin) {\n        this.value = 0;\n      } else if (isMax) {\n        this.value = this.max;\n      } else if (isNumber) {\n        const pressedNumber = parseInt(e.key);\n        this.value = pressedNumber > this.max ? this.max : pressedNumber;\n      }\n\n      this.fireEvent(\"change\");\n    }\n  }\n\n  _onfocusin() {\n    if (this.disabled) {\n      return;\n    }\n\n    this._focused = true;\n    this._liveValue = this.value;\n  }\n\n  _onfocusout() {\n    this._focused = false;\n  }\n\n  get effectiveTabIndex() {\n    const tabindex = this.getAttribute(\"tabindex\");\n    return this.disabled ? \"-1\" : tabindex || \"0\";\n  }\n\n  get ratingTooltip() {\n    return this.tooltip || this.defaultTooltip;\n  }\n\n  get defaultTooltip() {\n    return RatingIndicator.i18nBundle.getText(RATING_INDICATOR_TOOLTIP_TEXT);\n  }\n\n  get _ariaRoleDescription() {\n    return RatingIndicator.i18nBundle.getText(RATING_INDICATOR_TEXT);\n  }\n\n  get _ariaDisabled() {\n    return this.disabled || undefined;\n  }\n\n  get _ariaLabel() {\n    return getEffectiveAriaLabelText(this);\n  }\n\n  get _ariaDescription() {\n    return this.required ? RatingIndicator.i18nBundle.getText(RATING_INDICATOR_ARIA_DESCRIPTION) : undefined;\n  }\n\n  get ariaReadonly() {\n    return this.readonly ? \"true\" : undefined;\n  }\n\n  get classNames(): string {\n    return `udex-rating-indicator--${this.display.toLowerCase()}`;\n  }\n}\n\nRatingIndicator.define();\n\nexport default RatingIndicator;\n"]}